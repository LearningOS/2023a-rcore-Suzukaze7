## 总结
在`MemorySet`中
- 封装`translate_addr`提供虚拟地址到物理地址的映射
- 封装`(un)map_range`提供范围的(un)map

## 简答题
### 1
#### 页表组成
- [63 : 54] 未使用
- [53 : 10] 是页表项映射的物理页号
- [9 : 0] 标志位

#### 标志位
- v 表示当前页表项是否合法
- R/W/X 分别控制索引到这个页表项的对应虚拟页面是否允许读/写/取指
- U 控制索引到这个页表项的对应虚拟页面是否在 CPU 处于 U 特权级的情况下是否被允许访问
- A 记录自从页表项上的这一位被清零之后，页表项的对应虚拟页面是否被访问过
- D 记录自从页表项上的这一位被清零之后，页表项的对应虚拟页表是否被修改过

### 2
- 读/写/取指时遇到了非法的地址
- `sepc`记录缺页发生的指令地址，`scause`记录缺页原因，`stval`记录缺页发生时访问的地址
- 可以加快程序启动时响应速度；由于并不一定程序的所有内容都会被访问到，可以降低内存占用
- 物理页 $x = 10Gb = 10 * 2^{20}Kb = 2.5 * 10^{20}$页
  - 三级页表 $y = x / 512 = 5120$页
  - 二级页表 $z = y / 512 = 10$页
  
  所以页表大约为 $(y + z) * 4096 = 20Mb$
- 由上题可以得出页表占用比较小，所以我们可以在`mmap`时分配页表并向页表项打上特殊的标记，等到缺页时可以通过标记发现是 Lazy 分配的内存并实际分配物理内存
- 使用页表项[9 : 8]的标志位来标记对应的情况

### 3
- 不需要实际更换页表，而是切换特权级
- 将内核地址对应的页表项的 U 标志位置 0
- 简化了内核需要获取用户地址空间数据时的操作，加快了 trap 处理速度
- 和本章内容一样，在特权级切换时需要更换页表；同样在特权级切换时更换

## 荣誉准则
1. 在完成本次实验的过程（含此前学习的过程）中，我曾分别与 以下各位 就（与本次实验相关的）以下方面做过交流，还在代码中对应的位置以注释形式记录了具体的交流对象及内容：
```
无
```

2. 此外，我也参考了 以下资料 ，还在代码中对应的位置以注释形式记录了具体的参考来源及内容：
```
无
```

3. 我独立完成了本次实验除以上方面之外的所有工作，包括代码与文档。 我清楚地知道，从以上方面获得的信息在一定程度上降低了实验难度，可能会影响起评分。

4. 我从未使用过他人的代码，不管是原封不动地复制，还是经过了某些等价转换。 我未曾也不会向他人（含此后各届同学）复制或公开我的实验代码，我有义务妥善保管好它们。 我提交至本实验的评测系统的代码，均无意于破坏或妨碍任何计算机系统的正常运转。 我清楚地知道，以上情况均为本课程纪律所禁止，若违反，对应的实验成绩将按“-100”分计。